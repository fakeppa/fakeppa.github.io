import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,b as t,o as n}from"./app-BRegF2gW.js";const h={};function e(l,s){return n(),a("div",null,s[0]||(s[0]=[t(`<p>6,024 users solved</p><h4 id="description" tabindex="-1"><a class="header-anchor" href="#description"><span>Description</span></a></h4><p>What does asm1(0x2e0) return? Submit the flag as a hexadecimal value (starting with &#39;0x&#39;). NOTE: Your submission for this question will NOT be in the normal flag format. <a href="https://jupiter.challenges.picoctf.org/static/f1c2358ff7d1e9386e41552c549cf2f6/test.S" target="_blank" rel="noopener noreferrer">Source</a></p><h4 id="hints" tabindex="-1"><a class="header-anchor" href="#hints"><span>Hints</span></a></h4><p>assembly <a href="https://www.tutorialspoint.com/assembly_programming/assembly_conditions.htm" target="_blank" rel="noopener noreferrer">conditions</a></p><hr><h1 id="_00-前言" tabindex="-1"><a class="header-anchor" href="#_00-前言"><span>00. 前言</span></a></h1><p>这题考察了汇编语言中的分支结构，有关内容在本博客的汇编/汇编手册中介绍。<br> 另外，本题在picoCTF中十分特殊，答案不是以picoCTF{}为闭合的，而是直接把十六进制码打出来，包括0x这个前缀</p><h1 id="_01-解题过程" tabindex="-1"><a class="header-anchor" href="#_01-解题过程"><span>01. 解题过程</span></a></h1><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">asm1:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ebp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	mov</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    ebp,esp</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	cmp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    DWORD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PTR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ebp+0x8],0x3fb    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	jg</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0x512</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">asm1+3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">7&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+12</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	cmp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    DWORD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PTR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ebp+0x8],0x280</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+19</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	jne</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0x50a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">asm1+2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">9&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+21</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	mov</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    eax,DWORD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PTR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ebp+0x8]   </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+24</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    eax,0xa</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      ;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">eax:0x2ea</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+27</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	jmp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0x529</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">asm1+6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">0&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+29</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	mov</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    eax,DWORD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PTR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ebp+0x8]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	sub</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    eax,0xa</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+35</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	jmp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0x529</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">asm1+6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">0&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+37</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	cmp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    DWORD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PTR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ebp+0x8],0x559</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+44</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	jne</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0x523</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">asm1+5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">4&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+46</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	mov</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    eax,DWORD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PTR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ebp+0x8]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+49</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	sub</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    eax,0xa</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+52</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	jmp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0x529</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">asm1+6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">0&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+54</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	mov</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    eax,DWORD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PTR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ebp+0x8]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+57</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    eax,0xa</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+60</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	pop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    ebp</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+61</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	ret</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>本题传入参数为0x2e0</p><ul><li>为什么呢？<br> 在x86架构中，调用者会将参数push到栈中，<code>call</code> 指令会将返回地址压入栈中，然后跳转到指定的标签或地址处执行</li></ul><p>然后开始分析<br><code>DWORD PTR [ebp+0x8],0x3fb</code>：参数小于0x3fb<br> 不执行<code>jg</code><br><code>cmp DWORD PTR [ebp+0x8],0x280</code>：参数大于0x280<br> 执行<code>jne 0x50a &lt;asm1+29&gt;</code><br><code>&lt;+29&gt;: mov eax,DWORD PTR [ebp+0x8]</code>：把0x2e0赋给eax<br><code>&lt;+32&gt;: sub eax,0xa</code>:0x2e0-0xa=0x2d6<br> 然后跳转到60，那么eax内容就是0x2d6</p><p>flag:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>0x2d6</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,15)]))}const r=i(h,[["render",e],["__file","asm1.html.vue"]]),d=JSON.parse(`{"path":"/article/02_%E9%A2%86%E5%9F%9F/picoCTF/%E9%80%86%E5%90%91%20reverse/asm1.html","title":"asm1","lang":"zh-CN","frontmatter":{"icon":"pen-to-square","date":"2025-01-13T00:00:00.000Z","tags":null,"title":"asm1","category":["领域"],"description":"6,024 users solved Description What does asm1(0x2e0) return? Submit the flag as a hexadecimal value (starting with '0x'). NOTE: Your submission for this question will NOT be in ...","head":[["meta",{"property":"og:url","content":"https://github.com/fakeppa/fakeppa.github.io/article/02_%E9%A2%86%E5%9F%9F/picoCTF/%E9%80%86%E5%90%91%20reverse/asm1.html"}],["meta",{"property":"og:site_name","content":"问己"}],["meta",{"property":"og:title","content":"asm1"}],["meta",{"property":"og:description","content":"6,024 users solved Description What does asm1(0x2e0) return? Submit the flag as a hexadecimal value (starting with '0x'). NOTE: Your submission for this question will NOT be in ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-03-31T11:37:14.000Z"}],["meta",{"property":"article:published_time","content":"2025-01-13T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-03-31T11:37:14.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"asm1\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-01-13T00:00:00.000Z\\",\\"dateModified\\":\\"2025-03-31T11:37:14.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"fakeppa\\",\\"url\\":\\"https://github.com/fakeppa/fakeppa.github.io\\"}]}"]]},"headers":[],"git":{"createdTime":1736766049000,"updatedTime":1743421034000,"contributors":[{"name":"fakeppa","username":"fakeppa","email":"l17091799155@qq.com","commits":467,"url":"https://github.com/fakeppa"}]},"readingTime":{"minutes":1.27,"words":380},"filePathRelative":"article/02_领域/picoCTF/逆向 reverse/asm1.md","localizedDate":"2025年1月13日","excerpt":"<p>6,024&nbsp;users solved</p>\\n<h4>Description</h4>\\n<p>What does asm1(0x2e0) return? Submit the flag as a hexadecimal value (starting with '0x'). NOTE: Your submission for this question will NOT be in the normal flag format.&nbsp;<a href=\\"https://jupiter.challenges.picoctf.org/static/f1c2358ff7d1e9386e41552c549cf2f6/test.S\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Source</a></p>","autoDesc":true}`);export{r as comp,d as data};
