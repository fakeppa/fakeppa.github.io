---
icon: pen-to-square
date: 2025-02-28
tags: 
title: 常见的各种协议
category:
  - 项目
---
![](https://cdn.jsdelivr.net/gh/fakeppa/blog-img/20250228140958.png)
- 当LLC-PDU中携带的是数据的时候，那么左侧的2字节表示的就是长度；当然，以太帧可以携带其他协议，当LLC-PDU中是协议的时候，2字节就代表了类型。
- CRC为校验码。CRC实际上是生成FCS的算法
- 以太网帧最小为64字节，数据区取左侧46字节；最长为1518字节。
- 接口收到以太MAC帧时，接口自动校验后四个字节，传入设备时会自动去掉，所以抓不到
![image.png](https://cdn.jsdelivr.net/gh/fakeppa/blog-img/20250228143412.png)
- 以太网V2和802.3标准MAC帧
- 下面的最大长度1536，超过Length无法表示

# IP协议
![image.png](https://cdn.jsdelivr.net/gh/fakeppa/blog-img/20250228144328.png)

| IP报文字段         | 具体作用                                                                                                                      |
| -------------- | ------------------------------------------------------------------------------------------------------------------------- |
| 版本             | ip报文中，版本占了4位，用来表示该协议采用的是那一个版本的ip，相同版本的ip才能进行通信。一般此处的值为4，表示ipv4                                                            |
| 首部长度（头长度）      | 该字段用四位表示，表示整个ip包头的长度，其中数的单位是4字节。即二进制数0000-1111（十进制数0-15），其中一个最小长度为0字节，最大长度为60字节。一般来说此处的值为0101，表示头长度为20字节。有可选部分的话就会变成24个字节 |
| 区分服务 （Tos服务字段） | 该字段用8位表示。该字段一般情况下不使用。                                                                                                     |
| 总长度            | 该字段表示整个ip报文的长度，单位是1字节。能表示的最大字节为2^16-1=65535字节。不过由于链路层的MTU限制。超过1480字节后就会被分片（以太帧MTU为1500的情况下，除去20字节的包头）                     |
| 标识（==具备唯一性==）  | 该字段是ip软件实现的时候自动产生的，该字段的目的不是为了接受方的按序接受而设置的，而是在ip分片以后，用来标识同一片分片的。方便ip分片的重组。                                                 |
| 标志             | 该字段是与ip分片有关的。其中有三位，但只有两位是有效的，分别为MF，DF。MF标识后面是否还有分片，为1时，表示后面还有分片。DF标识是否能分片，为0表示可以分片。                                       |
| 片偏移            | 该字段是与ip分片后，相应的ip片在总的ip片的位置。该字段的单位是8字节 （下面有举例说明）                                                                           |
| 生存时间（TTL）      | ip分片每经过一个路由器该值减一，它的出现是为了防止路由环路，浪费带宽的问题。比如，该ip在R1 路由器发送到R2路由器。R2路由器又发给R1路由器。防止这种循环。window系统默认为128.                         |
| 协议             | ==该值标识上层的协议==。占8位，255种。其中1，标识ICMP、2标识IGMP、6标识TCP、17标识UDP、89标识OSPF。                                                        |
| 校验和（首部校验和）     | 该值是对整个数据包的包头进行的校验。占16位。==IPV6没有了校验==                                                                                      |
| 源地址和目的地址       | 标识发送ip片的源和目的ip，32位                                                                                                        |
| 可选部分           | 一般一些特殊的要求会加在这个部分。                                                                                                         |